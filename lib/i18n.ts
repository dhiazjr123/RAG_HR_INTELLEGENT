"use client";

const SETTINGS_STORAGE_KEY = "rag_user_settings";
export const SETTINGS_SAVED_EVENT = "rag-settings-saved";

export type Locale = "id" | "en";

export function getStoredLanguage(): Locale {
  if (typeof window === "undefined") return "id";
  try {
    const raw = localStorage.getItem(SETTINGS_STORAGE_KEY);
    if (!raw) return "id";
    const parsed = JSON.parse(raw) as { appearance?: { language?: string } };
    const lang = parsed?.appearance?.language;
    return lang === "en" ? "en" : "id";
  } catch {
    return "id";
  }
}

const translations: Record<Locale, Record<string, string>> = {
  id: {
    "settings.title": "Pengaturan",
    "settings.back": "Kembali",
    "settings.save": "Simpan",
    "settings.saved": "Tersimpan",
    "settings.menu.akun": "Akun",
    "settings.menu.notifikasi": "Notifikasi",
    "settings.menu.privacy": "Privasi & Keamanan",
    "settings.menu.tampilan": "Tampilan",
    "settings.menu.data": "Data & Dokumen",
    "settings.akun.title": "Akun",
    "settings.akun.email": "Email",
    "settings.akun.changePassword": "Ubah kata sandi",
    "settings.notifikasi.title": "Notifikasi",
    "settings.notifikasi.email": "Notifikasi email",
    "settings.notifikasi.emailDesc": "Pemberitahuan lewat email",
    "settings.notifikasi.push": "Push notifikasi",
    "settings.notifikasi.pushDesc": "Notifikasi dari browser",
    "settings.notifikasi.weekly": "Ringkasan mingguan",
    "settings.notifikasi.weeklyDesc": "Laporan aktivitas mingguan",
    "settings.privacy.title": "Privasi & Keamanan",
    "settings.privacy.visibility": "Visibilitas profil",
    "settings.privacy.visibilityPublic": "Publik",
    "settings.privacy.visibilityPrivate": "Privat",
    "settings.privacy.visibilityTeam": "Hanya tim",
    "settings.privacy.analytics": "Analitik",
    "settings.privacy.analyticsDesc": "Bantu meningkatkan layanan",
    "settings.tampilan.title": "Tampilan",
    "settings.tampilan.language": "Bahasa",
    "settings.tampilan.languageId": "Indonesia",
    "settings.tampilan.languageEn": "English",
    "settings.tampilan.fontSize": "Ukuran font",
    "settings.tampilan.fontSmall": "Kecil",
    "settings.tampilan.fontMedium": "Sedang",
    "settings.tampilan.fontLarge": "Besar",
    "settings.data.title": "Data & Dokumen",
    "settings.data.exportFormat": "Format ekspor",
    "settings.data.retention": "Retensi data (referensi)",
    "settings.data.retention30": "30 hari",
    "settings.data.retention6m": "6 bulan",
    "settings.data.retention1y": "1 tahun",
    "settings.data.retentionForever": "Selamanya",
    "settings.data.retentionHint": "Preferensi penyimpanan data lokal (dokumen & riwayat).",
    "settings.data.export": "Ekspor data",
    "sidebar.aiAssistant": "AI Assistant",
    "sidebar.overview": "Overview",
    "sidebar.documents": "Kelola Dokumen",
    "header.logout": "Logout",
    "header.loggingOut": "Logging out...",
    "header.profile": "Profile",
    "header.setting": "Setting",
    "header.enterprise": "Enterprise Department",
    "login.title": "Log In",
    "login.email": "Email",
    "login.password": "Kata sandi",
    "login.submit": "Log In",
    "login.signingIn": "Signing in...",
    "login.remember": "Remember me",
    "login.forgotPassword": "Forgot Password?",
    "login.or": "or",
    "login.google": "Continue with Google",
    "login.noAccount": "Belum punya akun?",
    "login.createAccount": "Buat akun",
    "register.title": "Sign Up",
    "register.name": "Nama",
    "register.email": "Email",
    "register.password": "Kata sandi",
    "register.confirmPassword": "Konfirmasi kata sandi",
    "register.submit": "Buat akun",
    "register.creating": "Creating...",
    "register.agree": "Saya setuju dengan syarat & kebijakan",
    "register.mismatch": "Konfirmasi password tidak cocok.",
    "register.or": "or",
    "register.google": "Sign up with Google",
    "register.hasAccount": "Sudah punya akun?",
    "register.login": "Log In",
    "forgot.title": "Lupa kata sandi?",
    "forgot.subtitle": "Kami akan mengirim pesan untuk mereset kata sandi Anda.",
    "forgot.email": "Email",
    "forgot.emailPlaceholder": "Masukkan email pribadi atau kerja",
    "forgot.submit": "Kirim link reset",
    "forgot.sending": "Mengirim...",
    "forgot.back": "Kembali",
    "profile.title": "Profile",
    "profile.edit": "Edit Profil",
    "profile.save": "Simpan",
    "documents.upload": "Upload Document",
    "documents.manage": "Kelola Dokumen",
    "documents.search": "Cari dokumen berdasarkan nama kandidat atau posisi pekerjaan...",
    "documents.filterAll": "Semua Tipe",
    "documents.filterCV": "CV Saja",
    "documents.filterJD": "Job Description Saja",
    "documents.reset": "Reset",
    "assistant.clearHistory": "Hapus riwayat",
    "assistant.chatHistory": "Riwayat Chat",
  },
  en: {
    "settings.title": "Settings",
    "settings.back": "Back",
    "settings.save": "Save",
    "settings.saved": "Saved",
    "settings.menu.akun": "Account",
    "settings.menu.notifikasi": "Notifications",
    "settings.menu.privacy": "Privacy & Security",
    "settings.menu.tampilan": "Appearance",
    "settings.menu.data": "Data & Documents",
    "settings.akun.title": "Account",
    "settings.akun.email": "Email",
    "settings.akun.changePassword": "Change password",
    "settings.notifikasi.title": "Notifications",
    "settings.notifikasi.email": "Email notifications",
    "settings.notifikasi.emailDesc": "Receive updates via email",
    "settings.notifikasi.push": "Push notifications",
    "settings.notifikasi.pushDesc": "Browser notifications",
    "settings.notifikasi.weekly": "Weekly summary",
    "settings.notifikasi.weeklyDesc": "Weekly activity reports",
    "settings.privacy.title": "Privacy & Security",
    "settings.privacy.visibility": "Profile visibility",
    "settings.privacy.visibilityPublic": "Public",
    "settings.privacy.visibilityPrivate": "Private",
    "settings.privacy.visibilityTeam": "Team only",
    "settings.privacy.analytics": "Analytics",
    "settings.privacy.analyticsDesc": "Help improve our service",
    "settings.tampilan.title": "Appearance",
    "settings.tampilan.language": "Language",
    "settings.tampilan.languageId": "Indonesia",
    "settings.tampilan.languageEn": "English",
    "settings.tampilan.fontSize": "Font size",
    "settings.tampilan.fontSmall": "Small",
    "settings.tampilan.fontMedium": "Medium",
    "settings.tampilan.fontLarge": "Large",
    "settings.data.title": "Data & Documents",
    "settings.data.exportFormat": "Export format",
    "settings.data.retention": "Data retention (reference)",
    "settings.data.retention30": "30 days",
    "settings.data.retention6m": "6 months",
    "settings.data.retention1y": "1 year",
    "settings.data.retentionForever": "Forever",
    "settings.data.retentionHint": "Local data storage preference (documents & history).",
    "settings.data.export": "Export data",
    "sidebar.aiAssistant": "AI Assistant",
    "sidebar.overview": "Overview",
    "sidebar.documents": "Manage Documents",
    "header.logout": "Logout",
    "header.loggingOut": "Logging out...",
    "header.profile": "Profile",
    "header.setting": "Settings",
    "header.enterprise": "Enterprise Department",
    "login.title": "Log In",
    "login.email": "Email",
    "login.password": "Password",
    "login.submit": "Log In",
    "login.signingIn": "Signing in...",
    "login.remember": "Remember me",
    "login.forgotPassword": "Forgot Password?",
    "login.or": "or",
    "login.google": "Continue with Google",
    "login.noAccount": "Don't have an account?",
    "login.createAccount": "Create account",
    "register.title": "Sign Up",
    "register.name": "Name",
    "register.email": "Email",
    "register.password": "Password",
    "register.confirmPassword": "Confirm Password",
    "register.submit": "Create account",
    "register.creating": "Creating...",
    "register.agree": "I agree to the terms & policy",
    "register.mismatch": "Password and confirmation do not match.",
    "register.or": "or",
    "register.google": "Sign up with Google",
    "register.hasAccount": "Already have an account?",
    "register.login": "Log in",
    "forgot.title": "Forgot password?",
    "forgot.subtitle": "We will send a message to reset your password.",
    "forgot.email": "Email Address",
    "forgot.emailPlaceholder": "Enter personal or work email address",
    "forgot.submit": "Send Reset Link",
    "forgot.sending": "Sending...",
    "forgot.back": "Back",
    "profile.title": "Profile",
    "profile.edit": "Edit Profile",
    "profile.save": "Save",
    "documents.upload": "Upload Document",
    "documents.manage": "Manage Documents",
    "documents.search": "Search by candidate name or job position...",
    "documents.filterAll": "All types",
    "documents.filterCV": "CV only",
    "documents.filterJD": "Job Description only",
    "documents.reset": "Reset",
    "assistant.clearHistory": "Clear history",
    "assistant.chatHistory": "Chat history",
  },
};

export function getTranslation(locale: Locale, key: string): string {
  const map = translations[locale];
  return map?.[key] ?? key;
}
